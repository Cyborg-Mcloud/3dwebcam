<!DOCTYPE html>
<html>
  <head>

  	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>3D Webcam</title>

        <meta charset="utf-8" />
        <meta name="format-detection" content="telephone=no" />
        <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1" />

	<script type="text/javascript" charset="utf-8" src="cordova.js"></script>


  </head>
  <style>
	body {color:white; margin:0px; padding:0px;}
	a {text-decoration:none; color:white;}
  </style>
  <body style='padding:0; border:0; margin:0;'>
  <div class="app">
            <h1>Apache Cordova</h1>
            <div id="deviceready" class="blink">
                <p class="event listening">Connecting to Device</p>
                <p class="event received">Device is Ready</p>
            </div>
        </div>
        <script type="text/javascript" src="cordova.js"></script>


        <script type="text/javascript">
         var ourBoard = 'CF:91:DD:57:15:F9';
//         app.initialize();
         var initialized = false;
         var accelerometerState = 'stopped';
         var connected = false;
         var initializeConnect = function(){
             if(initialized){
                 metawear.mwdevice.connect(ourBoard, connectedCallback, errorCallback);
             }else{
                 metawear.mwdevice.initialize(initializeCallback, errorCallback);
             }
         }
         
         var initializeCallback = function(result){
             initialized = true;
             metawear.mwdevice.connect(ourBoard, connectedCallback, errorCallback);
         }
         function connectDisconnect(){
             var finit = $("span");
             if(connected){
                 metawear.mwdevice.disconnect();
                 $("#connect_disconnect").siblings().find(finit).text("Connect");
                 connected = false;
            }else{
                 initializeConnect();
             }
         }
         var connectedCallback = function(result){
             $("#connection_status").text(result);
             console.log("Status : " + result);
             var finit = $("span");
             
             if(result === 'CONNECTED'){
               connected = true;
               $("#connect_disconnect").siblings().find(finit).text("Disconnect");
             }
             
             alert("Status: " + result);
         }
         
         var errorCallback = function(result){
             console.log("Error : " + result);
             alert("Error: " + result);
         }
         var successCallback = function(result){
             $("#rssi").text(result);
         } 
         var accelerometerCallback = function(result){
             var results = "x: " + result.x + " y: " + result.y + " z: " + result.z;
             $("#accelerometer").text(results);
         }
         function accelerometerStartStop(){
             var finit = $("span");
             if(accelerometerState === 'stopped'){
                 metawear.mwdevice.startAccelerometer(accelerometerCallback, errorCallback);
                 $("#accelerometer_button").siblings().find(finit).text("Stop Accelerometer");
                 accelerometerState = 'started';
            }else{
                 metawear.mwdevice.stopAccelerometer();
                 accelerometerState = 'stopped';
                 $("#accelerometer_button").siblings().find(finit).text("Start Accelerometer");
             }
         }
        </script> 

        <h2><div id="connection_status">Disconnected</div></h2>
        <button id="connect_disconnect" onClick="connectDisconnect()">Connect</button>
        <h3><div id="rssi"></div></h3>
        <button id="get_rssi" onClick="metawear.mwdevice.readRssi(successCallback, errorCallback)">GetRssi</button>
        <h3><div id="accelerometer"></div></h3>      
        <button id="accelerometer_button" onClick="accelerometerStartStop()">Start Accelerometer</button>

</body>



</html>
